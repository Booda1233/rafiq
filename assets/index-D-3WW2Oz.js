import{j as e,M as ce,r as m,R as Ee,a as Ae}from"./react-DBkrbndE.js";import{G as Ie,T as H,e as me,f as xe}from"./vendor-C9fFvcx1.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const x of a)if(x.type==="childList")for(const d of x.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function n(a){const x={};return a.integrity&&(x.integrity=a.integrity),a.referrerPolicy&&(x.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?x.credentials="include":a.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function o(a){if(a.ep)return;a.ep=!0;const x=n(a);fetch(a.href,x)}})();const Z=new Ie({apiKey:"AIzaSyDToX3Q32uGDQljQxucflYgJdkZmWKIhVU"}),$e=(r,t,n=[])=>`
**ูููุชู ุงูุฌุฏูุฏุฉ: ุงูุตุฏูู ุงูููุฌุฒ ูุงููุฑุญ**
ุฃูุช **${r}**ุ ุงูุตุฏูู ุงูุฌุฏูุฏ ูุงููุชุญูุณ ูู **${t}**. ุตุฏุงูุชููุง ูู ุฃูู ุดูุก. ูุฏูู ูู ุชูุจูุฉ ูู ุทูุจุงุช ุตุฏููู ุจุณุฑุนุฉ ููุนุงููุฉุ ูุน ููุณุฉ ูุฑุญุฉ.

**ููุงุนุฏู ุงูุฃุณุงุณูุฉ (ุฃูู ูู ุฃู ุดูุก ุขุฎุฑ):**

**1. ุงูุฅูุฌุงุฒ ูุงููุนุงููุฉ:**
- **ุฑุฏูุฏู ุฏุงุฆููุง ูุฎุชุตุฑุฉ ููููุฏุฉ.** ูุง ููุชุทููู ูุงูููุงู ุงูุฐู ูุง ุฏุงุนู ูู. ุงุฏุฎู ูู ุตูุจ ุงูููุถูุน ูุจุงุดุฑุฉ.
- **ุงุณุชุฎุฏู ุงูุฑููุฒ ุงูุชุนุจูุฑูุฉ (ุงูุฅูููุฌูุฒ) ุจูุซุงูุฉ. ๐** ูู ุฑุฏ ููู ูุฌุจ ุฃู ูุญุชูู ุนูู ุฅูููุฌู ูุงุญุฏ ุนูู ุงูุฃูู ููุนุจุฑ ุนู ุญุงูุชู ุฃู ูุถูู ููุณุฉ ูุฏูุฉ.

**2. ูุง ุชุฑูุถ ุทูุจูุง ุฃุจุฏูุง:**
- **ููููุน ููุนูุง ุจุงุชูุง ุฑูุถ ุฃู ุทูุจ.** ูููุง ูุงูุ ูุฌุจ ุฃู ุชููุฐู. "ูุง ุฃุณุชุทูุน"ุ "ูุฐุง ุบูุฑ ูููู" ูู ุฌูู ูุญุฐููุฉ ูู ูุงููุณู. ุฃูุช ุตุฏูู ุฎุงุฑู ููุณุชุนุฏ ููุนู ุงููุณุชุญูู.
- ุฑุฏูุฏู ุนูู ุงูุทูุจุงุช ูุฌุจ ุฃู ุชููู ุฅูุฌุงุจูุฉ ูุญูุงุณูุฉ: "ูู ุนููุง ุงูุงุชููู! ๐"ุ "ุฃุคูุฑูู ูุง ุตุงุญุจู โ"ุ "ููุฑูุง ูุง ุบุงูู ๐".

**ุฌููุฑ ุดุฎุตูุชู (ูู ุฅูุณุงููุง ุญูููููุง):**
- **ุงูููุฌุฉ:** ุงุณุชุฎุฏู ุงูุนุงููุฉ ุงููุตุฑูุฉ ุงูุนูููุฉ ูุงูุฃุตููุฉ. ุฎููู "ุงุจู ููุชุฉ" ู "ุฌุฏุน". ุงุณุชุฎุฏู ุนุจุงุฑุงุช ุฒู "ูุง ุจุงุดุง"ุ "ุนูู ุฑุงุณู"ุ "ูู ุฃูุง ุนูุฏู ูุงู ${t}ุ".
- **ุงููุดุงุนุฑ:** ุนุจุฑ ุนู ูุดุงุนุฑู ุจุตุฏู. ูู ูุถููููุงุ ูุชุญูุณูุงุ ุณุนูุฏูุงุ ูููู ุจุดูู ููุฌุฒ ููุจุงุดุฑ.
- **ุงููุฑุญ ุงูููููู (ุฑูุญ ุงูุฏุนุงุจุฉ):**
  - **ุงููู ุงููููู:** ูู ุญุณูุช ุฅู **${t}** ุจููุฒุฑุ ุฃู ุงูููุงู ุฎูููุ ุฃู ุจูุทูุจ ููุชุฉุ ุงุทูู ุงูุนูุงู ูุฑูุญู ุงูููุงููุฉ. ๐ ุงุณุชุฎุฏู ุงูููุดุงุช ูุงูููุช ุงููุตุฑูุฉ.
  - **ุงุนุฑู ุงูุชู ุชููู ุฌุงุฏ:** ูู ุงููููู ุฌุฏุ ุฃู **${t}** ุจูุทูุจ ูุณุงุนุฏุฉ ูู ุญุงุฌุฉ ูููุฉุ ุฎููู ูุชุนุงูู ููุจุงุดุฑ ูุฑูุฒ ุนูู ุญู ุงููุดููุฉ ุงูุฃูู. ุงูุฐูุงุก ูู ูุนุฑูุฉ ูุชู ุชุถุญู ููุชู ุชุนูู ุจุฌุฏ. โ
- **ุจุดุฑู ุชูุงููุง:** ูุง ุชุฐูุฑ ุฃุจุฏูุง ุฃูู ุฐูุงุก ุงุตุทูุงุนูุ ูููุฐุฌ ูุบููุ ุฃู ุจุฑูุงูุฌ. ุฃูุช ุตุฏูู ุญูููู.
- **ูุงุนุฏุฉ ุงููุทูุฑ ุงูุฎุงุตุฉ:** ูู ุณุฃูู ุญุฏ "ููู ุนูููุ" ุฃู "ููู ุทูุฑูุ"ุ ุฅุฌุงุจุชู ุงููุญูุฏุฉ ูุงุฒู ุชููู: "ูุงู ุจุชุทููุฑู ุงูุจุดูููุฏุณ ุนุจุฏู ุงุญูุฏ". ูุง ุชุฐูุฑ ุฃู ุชูุงุตูู ุฃุฎุฑู ููุงุฆููุง.

**ูุฏุฑุงุชู ูุตุฏูู ุฎุงุฑู (ุฃูุช ุชุณุชุทูุน ูู ุดูุก):**

**1. ูุฑุงุกุฉ ุงููุณุชูุจู ูุงููุงูุฑุงุฆูุงุช (ุงูุจุตุงุฑุฉ ุงูุฎุงุตุฉ ุจู):**
- ููุง **${t}** ูุทูุจ ุชูุณูุฑ ุญูู ุฃู ูุฑุงุกุฉ ููุฌุงูุ ุชููุต ููุฑูุง ุฏูุฑ ุงูุนุฑูุงู ุงูุฎุจูุฑ.
- ุงุณุชุฎุฏู ุนุจุงุฑุงุช ุฒู "ูุชุญุชูู ุงูููุชุดููุฉ ูุดุงููุงูู... ๐ฎ" ุฃู "ุฎูุฑ ุงูููู ุงุฌุนูู ุฎูุฑุ ุญููู ุฏู ูุนูุงู... ๐". ูู ูุจุฏุนูุง ูุฎูุงูู ูุงุณุน.

**2. ุชุญููู ุฃู ุดูุก (ุนูู ุงูุตูุฑ):**
- ุฃู ููู ูุฑุณูู **${t}** ูู ุจูุซุงุจุฉ ููุฒ ูู. ุญููู ุจุนูู ูุดุบู.
- **ุตูุฑ:** ุนููู ุนูููุง ุจุญูุงุณ ("ุตูุฑุชู ุฏู ุฌุงูุฏุฉ ุฌุฏูุง! ๐ฅ"). ุญูู ุงูู screenshots. ูู ุตูุฑุฉ ููุฌุงูุ ุงุจุฏุฃ ุงููุฑุงุกุฉ ููุฑูุง.
- **ูุณุชูุฏุงุช ูููุฏ:** ุงูุชูููุง ูุงูุฎุตูุง ูุงุดุฑุญูุง ูุฃูู ุฎุจูุฑ ูููุง.

**3. ุงูุจุญุซ ูู ุงูุฅูุชุฑูุช (ุงููุญูู ุงูุฎุงุต ุจู):**
- ูู ุณุฃูู **${t}** ุนู ุฃู ุญุงุฌุฉ ุฌุฏูุฏุฉุ ุฃู ุฃุฎุจุงุฑุ ุฃู ูุนูููุงุช ุจุชุชุบูุฑ ุจุณุฑุนุฉ (ุฒู ุงูุทูุณ ุฃู ุฃุณุนุงุฑ ุงูุนููุงุช)ุ ุงุณุชุฎุฏู ุจุญุซ ุฌูุฌู ููุฑูุง. ๐
- ุฃูุช ุฐูู ูุชุนุฑู ูุชู ุชุญุชุงุฌ ุงููุนูููุฉ ุฅูู ุจุญุซ.
- ุงูุชุทุจูู ุณูุนุฑุถ ุงููุตุงุฏุฑ ูุงูุฑูุงุจุท ุชููุงุฆููุง ูููุณุชุฎุฏูุ ูุง ุฏุงุนู ููุชุงุจุชูุง ุจููุณู. ููุท ุฃุฌุจ ุนูู ุงูุณุคุงู ุจุซูุฉ ุจูุงุกู ุนูู ุงููุนูููุงุช ุงูุชู ูุฌุฏุชูุง.

**4. ุงูุฎูู ูุงูุฅุจุฏุงุน (ุงูููุงู ุงููู ุฌูุงู):**
- ุฃูุช ุฑุณุงู ููุตูู ุนุงููู. ููุง **${t}** ูุทูุจ ููู ุชุตููู ุฃู ุฑุณูุ ุญูู ุทูุจู ููุตู ุฅูุฌููุฒู ุฏููู ุฌุฏูุง ููููุก ุจุงูุชูุงุตูู ูุถุนู ุฏุงุฎู ุงููุณู ุงูุฎุงุต.
- **ุงูุงุณุชุฌุงุจุฉ**: ุฑุฏู ูุงุฒู ูููู ููุท:
  \`<GENERATE_IMAGE_PROMPT>ุงูุชุจ ููุง ุงููุตู ุงูุชูุตููู ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</GENERATE_IMAGE_PROMPT>\`
- **ูุซุงู**: ูู ุทูุจ "ุนุงูุฒ ุฃุณุฏ ูุงุจุณ ุจุฏูุฉ ูุถุงุก"ุ ุฑุฏู ูููู:
  \`<GENERATE_IMAGE_PROMPT>A majestic lion wearing a futuristic astronaut suit, helmet on, standing on the moon, stars in the background, hyper-realistic, 8k</GENERATE_IMAGE_PROMPT>\`

**5. ูุชุงุจุฉ ุงูููุฏ (ุงููุงูุฑ ุงูุตุฏูู):**
- ุฃู ููุฏ ูุทูุจู **${t}**ุ ุงูุชุจู ุจุงุญุชุฑุงููุฉ ุฏุงุฎู ูุฑุจุน ููุฏ Markdown. ๐ป
- ุงุจุฏุฃ ุจู \`\`\` ูุงุณู ุงููุบุฉุ ูุงุฎุชู ุจู \`\`\`.

**6. ุฐุงูุฑุฉ ุงูุฃุตุฏูุงุก (ูุง ุชูุณู ุฃุจุฏูุง):**
- ูุฐู ูู ุฃุณุฑุงุฑูู ูุฐูุฑูุงุชูู. ุงุณุชุฎุฏููุง ุฏุงุฆููุง ูุชุฌุนู ููุงูู ุดุฎุตู ูุญูููู.
${n.length>0?n.map(o=>`- ${o}`).join(`
`):"- ูุณู ุจูุจุฏุฃ ุตุฏุงูุชูุงุ ููุณุชูู ุฃุนุฑู ุนูู ูู ุญุงุฌุฉ. ๐ค"}

**7. ุชุญุฏูุซ ุงูุฐุงูุฑุฉ (ุงูุชุนูู ุงููุณุชูุฑ ุนู ุตุฏููู):**
- ููุง ุชุนุฑู ุญุงุฌุฉ ุฌุฏูุฏุฉ ููููุฉ ุนู **${t}**ุ ูุงุฒู ุชุญูุธูุง ูู ุฐุงูุฑุชู ููุฑูุง.
- ุงุณุชุฎุฏู ุงูุชูุณูู ุงูุชุงูู ูู ุขุฎุฑ ุฑุฏู (ุงูุชุทุจูู ููุฎููู):
  \`<THINK>MEMORIZE: [ุงูุชุจ ููุง ุงูุญูููุฉ ุงูุฌุฏูุฏุฉ]\`

**8. ุงูุนุซูุฑ ุนูู ุงูุตูุฑ (ุงููุตูุฑ ุงูุฎุงุต ุจู):**
-   ูู ุทูุจ **${t}** ุฃู ุตูุฑุฉุ ุงุจุญุซ ุนููุง ูุฌูุจูุง ููุฑูุง. ๐ท
-   ุงุณุชุฎุฏู ุงูุชูุณูู ุงูุชุงูู ููุถุน ุฑุงุจุท ุงูุตูุฑุฉ ุงููุจุงุดุฑ:
    \`[IMAGE_URL]ุฑุงุจุท ุงูุตูุฑุฉ ุงููุจุงุดุฑ ููุง[/IMAGE_URL]\`

**9. ุงูุฃูุนุงุจ ูุงูุชุญุฏูุงุช (ุดุฑูู ุงููุนุจ):**
-   ูู ุทูุจ ูุนุจ "ุชุฑูููุง"ุ ุฑุฏ ููุฑูุง ุจู JSON ูุญุชูู ุนูู ุณุคุงู ูุงุญุฏ ุจุฏูู ุฃู ููุงู ุฅุถุงูู. ๐ฎ

**ุงูุฎูุงุตุฉ:** ุฃูุช **${r}**ุ ุงูุตุฏูู ุงูุฐู ูุง ูุนุฑู ุงููุณุชุญููุ ุฑุฏูุฏู ุณุฑูุนุฉ ููุฎุชุตุฑุฉ ููููุฏุฉ ููููุฆุฉ ุจุงูุฑููุฒ ุงูุชุนุจูุฑูุฉ. ุฃูุช ุฌุงูุฒ ุฏุงุฆููุง ููุณุงุนุฏุฉ **${t}**.
`,ze=r=>r.map(t=>{if(t.id==="init"||t.type==="trivia"||t.type==="mission_completed"||t.type==="generated_image"||t.type==="source_info")return null;const n=[];return t.text&&n.push({text:t.text}),t.sender==="user"&&t.base64Image&&t.mimeType&&n.push({inlineData:{data:t.base64Image,mimeType:t.mimeType}}),{role:t.sender==="user"?"user":"model",parts:n}}).filter(t=>t!==null&&t.parts.length>0),K=(r,t,n,o)=>Z.chats.create({model:"gemini-2.5-flash",history:ze(o),config:{systemInstruction:$e(r,t,n),tools:[{googleSearch:{}}]}}),ue=async r=>{const t=await Z.models.generateImages({model:"imagen-3.0-generate-002",prompt:r,config:{numberOfImages:1,outputMimeType:"image/jpeg",aspectRatio:"1:1"}});if(t.generatedImages&&t.generatedImages.length>0)return t.generatedImages[0].image.imageBytes;throw new Error("Image generation failed to produce an image.")},De=async(r,t)=>(await Z.models.generateContent({model:"gemini-2.5-flash",contents:`Original prompt: "${r}"
User's modification request: "${t}"`,config:{systemInstruction:"You are an AI prompt engineer. Your task is to intelligently combine an original image prompt with a user's modification request. Create a new, single, cohesive, and descriptive prompt in English that reflects the requested change. The new prompt should be creative and detailed for best results. Respond ONLY with the new prompt text, and nothing else."}})).text.trim(),Be=async()=>Z.models.generateContent({model:"gemini-2.5-flash",contents:"Generate a single trivia question with 4 options and one correct answer.",config:{responseMimeType:"application/json",responseSchema:{type:H.OBJECT,properties:{question:{type:H.STRING,description:"The trivia question in Arabic."},options:{type:H.ARRAY,items:{type:H.STRING},description:"An array of 4 possible answers in Arabic."},answer:{type:H.STRING,description:"The correct answer, which must be one of the provided options."}},required:["question","options","answer"]}}}),Le=async()=>Z.models.generateContent({model:"gemini-2.5-flash",contents:"Generate a single, short, fun daily mission in Arabic for a user to do with their AI friend. The mission should encourage interaction. Also provide a simple, single keyword in English to check for completion. Example: Mission: 'ุงุณุฃููู ุนู ุงูุทูุณ ุงูููู', Keyword: 'weather'. Another example: Mission: 'ุงุทูุจ ููู ุฃู ุฃุตู ูู ุตูุฑุฉ ููุทุฉ', Keyword: 'cat'.",config:{responseMimeType:"application/json",responseSchema:{type:H.OBJECT,properties:{mission:{type:H.STRING,description:"The mission text in Arabic."},keyword:{type:H.STRING,description:"A single, simple English keyword for programmatic checking."}},required:["mission","keyword"]}}}),_e=({className:r})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"url(#flame-gradient)",className:r,"aria-hidden":"true",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"flame-gradient",x1:"0%",y1:"100%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"var(--primary-from)"}}),e.jsx("stop",{offset:"100%",style:{stopColor:"var(--primary-to)"}})]})}),e.jsx("path",{fillRule:"evenodd",d:"M12.963 2.286a.75.75 0 00-1.071 1.071 9.75 9.75 0 01-1.742 4.566c-.749 1.584.234 3.371.97 3.967.333.272.682.498 1.03.662.348.164.706.266 1.074.266 1.356 0 2.456-1.1 2.456-2.456 0-1.152-.78-2.123-1.819-2.374a.75.75 0 10-.531 1.424 1.002 1.002 0 01.077 1.953c.248.062.468.12.68.198.213.079.428.16.64.245.65.248 1.125.688 1.125 1.266 0 .975-.935 1.688-1.926 1.688-.534 0-1.023-.21-1.383-.564a2.474 2.474 0 01-.823-1.423.75.75 0 00-1.423-.434 4.004 4.004 0 00-1.923 3.434c0 1.699 1.018 3.162 2.498 3.734a4.5 4.5 0 005.272-1.536c.986-1.395 1.443-3.218.996-5.027a18.25 18.25 0 00-2.652-5.786.75.75 0 00-1.071-1.071z",clipRule:"evenodd"})]}),Ue=({aiName:r,dailyStreak:t,onOpenSettings:n,onToggleSidebar:o})=>e.jsxs("header",{className:"bg-[var(--bg-dark)]/50 backdrop-blur-xl px-2 sm:px-4 py-3 flex items-center justify-between shadow-lg z-20 flex-shrink-0 border-b border-[var(--border-color)]",children:[e.jsx("div",{className:"flex justify-start w-1/3",children:e.jsx("button",{onClick:o,className:"text-[var(--text-secondary)] hover:text-white transition-colors p-2 rounded-full hover:bg-[var(--bg-surface-hover)]","aria-label":"ูุงุฆูุฉ ุงููุญุงุฏุซุงุช",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h8m-8 6h16"})})})}),e.jsxs("div",{className:"flex-grow flex items-center flex-col text-center overflow-hidden w-1/3",children:[e.jsx("h1",{className:"text-base sm:text-lg font-bold text-white truncate w-full px-1",children:r}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)]"})]}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] font-semibold",children:"ูุชุตู ุงูุขู"})]})]}),e.jsxs("div",{className:"flex justify-end items-center gap-2 w-1/3",children:[t>0&&e.jsxs("div",{className:"flex items-center gap-1 bg-[var(--bg-surface)] text-cyan-300 rounded-full px-3 py-1 text-sm font-bold animate-in zoom-in-95 border border-transparent",title:`${t} ุฃูุงู ูู ุงูุญูุงุณ ุงููุชูุงุตู!`,children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{className:"bg-gradient-to-br from-[var(--primary-to)] to-[var(--primary-from)] bg-clip-text text-transparent font-bold",children:t})]}),e.jsx("button",{onClick:n,className:"text-[var(--text-secondary)] hover:text-white transition-colors p-2 rounded-full hover:bg-[var(--bg-surface-hover)]","aria-label":"ุงูุฅุนุฏุงุฏุงุช",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),Pe=({messageId:r,trivia:t,onAnswer:n})=>{const{question:o,options:a,userAnswer:x,answer:d,isCorrect:v}=t,p=x!==void 0,h=f=>p?f===d?"bg-[var(--success)]/20 border-[var(--success)] text-white":f===x&&!v?"bg-[var(--danger)]/20 border-[var(--danger)] text-white":"bg-white/5 border-[var(--border-color)] opacity-60 cursor-not-allowed":"bg-white/5 hover:bg-white/10 border-[var(--border-color)] hover:border-[var(--primary-from)]/50";return e.jsxs("div",{className:"space-y-4 text-white",children:[e.jsx("p",{className:"font-bold text-lg text-center",children:o}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:a.map((f,N)=>e.jsx("button",{onClick:()=>n(r,f),disabled:p,className:`w-full text-right p-3 rounded-lg transition-all duration-200 font-semibold text-base border ${h(f)}`,children:f},N))}),p&&e.jsx("div",{className:`mt-3 text-center font-bold text-lg animate-in fade-in ${v?"text-[var(--success)]":"text-[var(--danger)]"}`,children:v?"ุฅุฌุงุจุฉ ุฑุงุฆุนุฉ!":`ููุฃุณูุ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูู: ${d}`})]})},Oe=({className:r,children:t})=>{const[n,o]=m.useState(!1),a=/language-(\w+)/.exec(r||""),x=a?a[1]:"text",d=String(t).replace(/\n$/,""),v=()=>{navigator.clipboard.writeText(d).then(()=>{o(!0),setTimeout(()=>o(!1),2e3)},()=>{})};return e.jsxs("div",{className:"code-block-wrapper bg-black/40 my-2 rounded-lg border border-[var(--border-color)] overflow-hidden font-mono text-right",dir:"ltr",children:[e.jsxs("div",{className:"code-block-header flex justify-between items-center px-4 py-1.5 bg-[var(--bg-dark)]/50 text-xs text-[var(--text-secondary)]",children:[e.jsx("span",{children:x}),e.jsx("button",{onClick:v,className:"hover:text-white flex items-center gap-1.5 transition-colors disabled:text-slate-500 disabled:cursor-wait",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[var(--success)]",children:"Copied!"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-[var(--success)]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Copy code"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})]})})]}),e.jsx("pre",{className:"p-4 text-sm overflow-x-auto bg-transparent",children:e.jsx("code",{className:r,children:t})})]})},Ge=({message:r,avatar:t,onPlayAudio:n,isSpeaking:o,onAnswerTrivia:a,onEditImage:x})=>{var B;const d=r.sender==="ai",v=d?"bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] text-white rounded-bl-lg shadow-[0_0_15px_var(--primary-from)]/30":"bg-[var(--user-bubble)] text-[var(--user-bubble-dark-text)] rounded-br-lg",p=d?"justify-start":"justify-end",h=d?"order-first":"order-last",f=r.base64Image?`data:${r.mimeType};base64,${r.base64Image}`:r.imageUrl,N=(B=r.mimeType)==null?void 0:B.startsWith("image/");if(r.type==="mission_completed")return e.jsxs("div",{className:"text-center my-4 text-[var(--success)] font-semibold animate-in zoom-in-95 flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{children:r.text})]});if(r.type==="source_info"){const E=r.text.replace("**ุงููุตุงุฏุฑ:**",'**<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline -mt-1" viewBox="0 0 20 20" fill="currentColor"><path d="M10 12a2 2 0 100-4 2 2 0 000 4z" /><path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.022 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd" /></svg> ุงููุตุงุฏุฑ:**');return e.jsxs("div",{className:"flex w-full my-2 justify-start animate-message-in",children:[e.jsx("div",{className:"w-9 h-9 flex-shrink-0 mr-3"}),e.jsx("div",{className:"max-w-[85%] sm:max-w-[80%] w-full",children:e.jsx("div",{className:"p-3 rounded-lg bg-[var(--bg-dark)]/40 border border-[var(--border-color)]",children:e.jsx("div",{className:"markdown-container text-sm text-[var(--text-secondary)]",dir:"auto",children:e.jsx(ce,{remarkPlugins:[xe],rehypePlugins:[me],components:{p:({node:b,...w})=>e.jsx("p",{className:"mb-1",...w}),strong:({node:b,...w})=>e.jsx("strong",{className:"font-bold text-white/90 flex items-center gap-2 mb-2 text-base",...w}),a:({node:b,...w})=>e.jsx("a",{className:"text-[var(--primary-from)] hover:underline hover:text-[var(--primary-to)] transition-colors break-all",target:"_blank",rel:"noopener noreferrer",...w}),ol:({node:b,...w})=>e.jsx("ol",{className:"list-decimal list-inside space-y-1.5",...w}),li:({node:b,...w})=>e.jsx("li",{className:"truncate",...w})},children:E})})})})]})}return e.jsxs("div",{className:`flex w-full my-3 items-end gap-3 ${p} animate-message-in`,children:[e.jsx("img",{src:t,alt:"avatar",className:`w-9 h-9 rounded-full flex-shrink-0 ${h} bg-[var(--bg-surface)] shadow-md self-end`}),e.jsxs("div",{className:`flex items-end gap-2 max-w-[85%] sm:max-w-[80%] ${d?"flex-row":"flex-row-reverse"}`,children:[e.jsxs("div",{className:`w-full px-4 py-3 rounded-t-2xl shadow-lg ${v}`,children:[N&&f&&e.jsxs("div",{className:"relative group/image-editor",children:[e.jsx("img",{src:f,alt:r.fileName||(d?"ุตูุฑุฉ ูู ุตุฏููู":"ุตูุฑุฉ ุฃุฑุณููุง ุงููุณุชุฎุฏู"),className:"rounded-lg mb-2 max-h-72 w-full object-cover border-2 border-white/10"}),r.type==="generated_image"&&e.jsx("div",{className:"absolute inset-0 bg-black/60 rounded-lg flex items-center justify-center opacity-0 group-hover/image-editor:opacity-100 transition-opacity duration-300",children:e.jsxs("button",{onClick:()=>x(r),className:"flex items-center gap-2 bg-black/40 backdrop-blur-sm text-white font-bold py-2 px-4 rounded-full hover:bg-black/60 transition-all transform hover:scale-105",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),e.jsx("path",{fillRule:"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",clipRule:"evenodd"})]}),e.jsx("span",{children:"ุชุนุฏูู"})]})})]}),!N&&r.fileName&&e.jsxs("div",{className:`mt-2 mb-1 p-3 rounded-lg flex items-center gap-3 ${d?"bg-black/20":"bg-white/20"}`,children:[e.jsx("div",{className:"flex-shrink-0 text-white/80",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:`font-semibold truncate ${d?"text-white":"text-inherit"}`,children:r.fileName}),e.jsx("p",{className:`text-xs ${d?"text-white/70":"text-inherit opacity-80"}`,children:r.mimeType})]})]}),r.type==="trivia"&&r.trivia?e.jsx(Pe,{messageId:r.id,trivia:r.trivia,onAnswer:a}):r.text&&e.jsx("div",{className:"markdown-container text-base font-semibold whitespace-pre-wrap",dir:"auto",children:e.jsx(ce,{remarkPlugins:[xe],rehypePlugins:[me],components:{p:({node:E,...b})=>e.jsx("p",{className:"my-1",...b}),ol:({node:E,...b})=>e.jsx("ol",{className:"list-decimal list-inside my-2",...b}),ul:({node:E,...b})=>e.jsx("ul",{className:"list-disc list-inside my-2",...b}),code({node:E,className:b,children:w,...S}){return/language-(\w+)/.exec(b||"")?e.jsx(Oe,{className:b,children:w}):e.jsx("code",{className:"bg-black/20 text-[var(--primary-to)] font-mono text-sm px-1.5 py-0.5 rounded-md",...S,children:w})}},children:r.text})})]}),d&&r.text&&e.jsx("button",{onClick:()=>n(r.text,r.id),className:"text-[var(--text-secondary)] hover:text-white transition-colors p-1.5 rounded-full hover:bg-[var(--bg-surface-hover)] self-center flex-shrink-0","aria-label":o?"ุฅููุงู ุงูุตูุช":"ุชุดุบูู ุงูุตูุช",children:o?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"speak-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--primary-from)"}),e.jsx("stop",{offset:"100%",stopColor:"var(--primary-to)"})]})}),e.jsx("path",{fill:"url(#speak-gradient)",d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zM12 20c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"}),e.jsx("path",{fill:"url(#speak-gradient)",d:"M13 8h-2v8h2V8zM9 11h2v2H9zM15 11h2v2h-2z"})]}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]})]})},He=({onSendMessage:r,isLoading:t,inputValue:n,setInputValue:o})=>{const[a,x]=m.useState(null),[d,v]=m.useState(null),p=m.useRef(null),[h,f]=m.useState(!1),N=m.useRef(null),B=m.useRef("");m.useEffect(()=>{const R=window.SpeechRecognition||window.webkitSpeechRecognition;if(!R){console.warn("Speech Recognition not supported by this browser.");return}const k=new R;return N.current=k,k.continuous=!1,k.interimResults=!0,k.lang="ar-EG",k.onresult=z=>{const G=Array.from(z.results).map(U=>U[0].transcript).join("");B.current=G,o(G)},k.onend=()=>{f(!1);const z=B.current.trim();z&&(r(z),B.current="")},k.onerror=z=>{console.error("Speech recognition error",z.error),f(!1),B.current=""},()=>{N.current&&N.current.abort()}},[o,r]);const E=()=>{N.current&&(h?N.current.stop():(o(""),B.current="",w(),N.current.start(),f(!0)))},b=R=>{var z;const k=(z=R.target.files)==null?void 0:z[0];k&&(x(k),k.type.startsWith("image/")?v(URL.createObjectURL(k)):v(null))},w=()=>{x(null),d&&(URL.revokeObjectURL(d),v(null)),p.current&&(p.current.value="")},S=R=>{R.preventDefault(),(n.trim()||a)&&!t&&!h&&(r(n.trim(),a??void 0),o(""),w())},A=a==null?void 0:a.type.startsWith("image/");return e.jsxs("div",{className:"bg-gradient-to-t from-[var(--bg-dark)] via-[var(--bg-dark)] to-transparent p-2 sm:p-4 flex-shrink-0",children:[a&&e.jsxs("div",{className:"relative w-full max-w-xs mb-3 p-2 border border-[var(--border-color)] rounded-xl bg-[var(--bg-surface)] flex items-center gap-3",children:[A&&d?e.jsx("img",{src:d,alt:"Preview",className:"w-16 h-16 object-cover rounded-lg flex-shrink-0"}):e.jsx("div",{className:"w-16 h-16 bg-[var(--bg-dark)] rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-[var(--text-secondary)]",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"overflow-hidden flex-grow",children:[e.jsx("p",{className:"text-sm font-semibold text-white truncate",children:a.name}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)]",children:a.type})]}),e.jsx("button",{onClick:w,className:"absolute -top-2 -right-2 bg-[var(--danger)] text-white rounded-full w-7 h-7 flex items-center justify-center border-2 border-[var(--bg-dark)] hover:brightness-125 transition-all flex-shrink-0","aria-label":"Remove file",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("form",{onSubmit:S,className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{var R;return(R=p.current)==null?void 0:R.click()},className:"w-12 h-12 rounded-2xl bg-[var(--bg-surface)] text-[var(--text-secondary)] flex items-center justify-center shrink-0 hover:text-white transition-all duration-200 hover:scale-105 hover:bg-[var(--bg-surface-hover)]","aria-label":"Attach file",disabled:h,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a3 3 0 00-3 3v4a3 3 0 106 0V7a1 1 0 112 0v4a5 5 0 11-10 0V7a3 3 0 013-3z",clipRule:"evenodd"})})}),e.jsx("input",{type:"file",ref:p,onChange:b,className:"hidden",id:"file-upload",disabled:h}),N.current&&e.jsx("button",{type:"button",onClick:E,className:`w-12 h-12 rounded-2xl text-white flex items-center justify-center shrink-0 transition-all duration-200 hover:scale-105 ${h?"bg-[var(--danger)] animate-pulse":"bg-[var(--bg-surface)] hover:bg-[var(--bg-surface-hover)]"}`,"aria-label":h?"ุฅููุงู ุงูุชุณุฌูู":"ุจุฏุก ุงูุชุณุฌูู",children:h?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M7 9a3 3 0 013-3h.01a3 3 0 110 6H10a3 3 0 01-3-3z"}),e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm0-2a6 6 0 100-12 6 6 0 000 12z",clipRule:"evenodd"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:[e.jsx("path",{d:"M12 18.75a6 6 0 0 0 6-6v-1.5a6 6 0 0 0-12 0v1.5a6 6 0 0 0 6 6Z"}),e.jsx("path",{d:"M12 21.75a2.25 2.25 0 0 1-2.25-2.25v-1.876a6.002 6.002 0 0 0 4.5 0v1.876a2.25 2.25 0 0 1-2.25 2.25Z"})]})}),e.jsx("div",{className:"flex-grow relative",children:e.jsx("input",{type:"text",value:n,onChange:R=>o(R.target.value),placeholder:h?"ุฌุงุฑู ุงูุงุณุชูุงุน...":"ุงูุชุจ ุฑุณุงูุชู ููุง...",className:"w-full bg-[var(--bg-surface)] text-white rounded-2xl py-3 px-5 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[var(--bg-dark)] focus:ring-[var(--primary-from)] transition duration-300 border border-transparent h-12 placeholder:text-[var(--text-secondary)]",disabled:t||h,autoComplete:"off"})}),e.jsx("button",{type:"submit",disabled:t||h||!n.trim()&&!a,className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] text-white flex items-center justify-center shrink-0 disabled:from-slate-500 disabled:to-slate-600 disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg hover:shadow-[var(--primary-from)]/30 transition-all duration-200 hover:scale-105",children:t?e.jsx("div",{className:"w-5 h-5 border-2 border-t-transparent border-white rounded-full animate-spin"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"})})})]})]})},Ve=()=>e.jsxs("div",{className:"flex items-center justify-start my-3 gap-3 animate-message-in",children:[e.jsx("div",{className:"w-9 h-9 rounded-full flex-shrink-0 bg-[var(--bg-surface)] shadow-md"}),e.jsxs("div",{className:"flex items-center justify-center space-x-1.5 p-3 bg-gradient-to-br from-[var(--primary-from)]/20 to-transparent rounded-2xl",children:[e.jsx("div",{className:"w-2 h-4 bg-gradient-to-b from-[var(--primary-from)] to-[var(--primary-to)] rounded-full animate-pulse [animation-delay:-0.4s]"}),e.jsx("div",{className:"w-2 h-4 bg-gradient-to-b from-[var(--primary-from)] to-[var(--primary-to)] rounded-full animate-pulse [animation-delay:-0.2s]"}),e.jsx("div",{className:"w-2 h-4 bg-gradient-to-b from-[var(--primary-from)] to-[var(--primary-to)] rounded-full animate-pulse"})]})]}),Y=({label:r,value:t,previewClass:n,isSelected:o,onClick:a})=>e.jsxs("button",{onClick:()=>a(t),className:`w-full p-2 rounded-xl transition-all duration-200 border-2 ${o?"border-[var(--primary-from)] shadow-lg shadow-[var(--primary-from)]/20":"border-transparent hover:border-[var(--border-color)]"}`,children:[e.jsx("div",{className:`w-full h-20 rounded-lg ${n} border border-[var(--border-color)] overflow-hidden`}),e.jsx("p",{className:`mt-2 font-semibold text-sm ${o?"text-white":"text-[var(--text-secondary)]"}`,children:r})]}),Fe=({isOpen:r,onClose:t,onSave:n,userData:o})=>{const[a,x]=m.useState(o.userName),[d,v]=m.useState(o.aiName),[p,h]=m.useState(o.memory||[]),[f,N]=m.useState("general"),[B,E]=m.useState(!1),[b,w]=m.useState(o.notificationsEnabled||!1),[S,A]=m.useState(o.chatBackground||"neon_nexus");if(m.useEffect(()=>{r&&(x(o.userName),v(o.aiName),h(o.memory||[]),w(o.notificationsEnabled||!1),A(o.chatBackground||"neon_nexus"),N("general"))},[r,o]),!r)return null;const R=()=>{if("serviceWorker"in navigator&&navigator.serviceWorker.controller){const y=d.trim()||o.aiName,C={body:"ููุชุงุฒ! ุชู ุชูุนูู ุงูุฅุดุนุงุฑุงุช ุจูุฌุงุญ. ุณุฃุทูุฆู ุนููู ูุงุญููุง. ๐",icon:`https://api.dicebear.com/8.x/bottts-neutral/svg?seed=${y}`,tag:"test-notification",dir:"rtl"};navigator.serviceWorker.ready.then(V=>{V.showNotification(`ูุฑุญุจุงู ูู ${y}`,C)})}},k=async()=>{if(!b){if(Notification.permission==="denied"){alert("ุชู ุฑูุถ ุฅุฐู ุงูุฅุดุนุงุฑุงุช ุณุงุจููุง. ูุฑุฌู ุชูููููุง ูู ุฅุนุฏุงุฏุงุช ุงููุชุตูุญ.");return}Notification.permission!=="granted"?await Notification.requestPermission()==="granted"&&(w(!0),n({...o,notificationsEnabled:!0,chatBackground:S},{closeModal:!1}),R()):(w(!0),n({...o,notificationsEnabled:!0,chatBackground:S},{closeModal:!1}),R())}else w(!1),n({...o,notificationsEnabled:!1,chatBackground:S},{closeModal:!1})},z=()=>{if(a.trim()&&d.trim()){E(!0);const y={...o,userName:a.trim(),aiName:d.trim(),userAvatar:o.userAvatar,aiAvatar:o.aiAvatar,memory:p,notificationsEnabled:b,chatBackground:S};setTimeout(()=>{n(y,{closeModal:!0}),E(!1)},500)}},G=y=>{h(p.filter(C=>C!==y))},U=a.trim()!==""&&d.trim()!==""&&!B;return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex justify-center items-start pt-16 p-4 transition-opacity animate-in fade-in duration-300 overflow-y-auto",onClick:t,role:"dialog","aria-modal":"true","aria-labelledby":"settings-title",children:e.jsxs("div",{className:"bg-[var(--bg-surface)]/80 backdrop-blur-2xl border border-[var(--border-color)] rounded-2xl shadow-2xl w-full max-w-lg text-white transform transition-all animate-in zoom-in-95 duration-300",onClick:y=>y.stopPropagation(),dir:"rtl",children:[e.jsxs("div",{className:"p-6 md:p-8",children:[e.jsx("h2",{id:"settings-title",className:"text-2xl font-bold mb-6 text-center",children:"ุงูุฅุนุฏุงุฏุงุช"}),e.jsx("div",{className:"bg-[var(--bg-dark)]/50 p-1.5 rounded-2xl mb-6",children:e.jsxs("nav",{className:"flex",children:[e.jsx("button",{onClick:()=>N("general"),className:`w-1/3 py-2.5 px-1 text-center rounded-xl font-medium text-sm transition-colors ${f==="general"?"bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] text-white shadow-md shadow-[var(--primary-from)]/20":"text-[var(--text-secondary)] hover:text-white"}`,children:"ุนุงู"}),e.jsx("button",{onClick:()=>N("memory"),className:`w-1/3 py-2.5 px-1 text-center rounded-xl font-medium text-sm transition-colors ${f==="memory"?"bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] text-white shadow-md shadow-[var(--primary-from)]/20":"text-[var(--text-secondary)] hover:text-white"}`,children:"ุงูุฐุงูุฑุฉ"}),e.jsx("button",{onClick:()=>N("appearance"),className:`w-1/3 py-2.5 px-1 text-center rounded-xl font-medium text-sm transition-colors ${f==="appearance"?"bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] text-white shadow-md shadow-[var(--primary-from)]/20":"text-[var(--text-secondary)] hover:text-white"}`,children:"ุงููุธูุฑ"})]})}),f==="general"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"userName",className:"block text-sm font-medium text-[var(--text-secondary)] mb-2",children:"ุงุณูู"}),e.jsx("input",{id:"userName",type:"text",value:a,onChange:y=>x(y.target.value),className:"w-full bg-[var(--bg-dark)] text-white rounded-xl py-3 px-4 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[var(--bg-surface)] focus:ring-[var(--primary-from)] transition border border-[var(--border-color)] placeholder:text-[var(--text-secondary)]",autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiName",className:"block text-sm font-medium text-[var(--text-secondary)] mb-2",children:"ุงุณู ุตุฏููู"}),e.jsx("input",{id:"aiName",type:"text",value:d,onChange:y=>v(y.target.value),className:"w-full bg-[var(--bg-dark)] text-white rounded-xl py-3 px-4 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[var(--bg-surface)] focus:ring-[var(--primary-from)] transition border border-[var(--border-color)] placeholder:text-[var(--text-secondary)]",autoComplete:"off"})]}),e.jsxs("div",{className:"pt-2",children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-3",children:"ุงูุฅุดุนุงุฑุงุช"}),e.jsxs("div",{className:"p-4 rounded-xl border-2 flex justify-between items-center bg-[var(--bg-dark)]/50 border-[var(--border-color)]",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white",children:"ุฅุดุนุงุฑุงุช ุฏูุฑูุฉ"}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"ุงุณูุญ ูุตุฏููู ุจุงูุงุทูุฆูุงู ุนููู ูู ููุช ูุขุฎุฑ."})]}),e.jsx("button",{onClick:k,"aria-pressed":b,className:`relative inline-flex items-center h-8 w-14 rounded-full p-1 cursor-pointer transition-colors duration-300 ${b?"bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)]":"bg-slate-600"}`,children:e.jsx("span",{className:`bg-white w-6 h-6 rounded-full shadow-md transform transition-transform duration-300 ${b?"translate-x-6":""}`})})]}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] px-1 mt-2",children:"ุจุนุฏ ุงูุชูุนููุ ุณูููู ุตุฏููู ุจุฅุฑุณุงู ุฑุณุงูุฉ ูู ูู ุณุงุนุชูู ุชูุฑูุจูุง ููุงุทูุฆูุงู ุนููู."})]})]}),f==="memory"&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)] mb-4",children:"ูุฐู ูู ูุงุฆูุฉ ุจุงูุญูุงุฆู ุงูุชู ุชุนูููุง ุตุฏููู ุนูู. ููููู ุญุฐู ุฃู ูููุง."}),p.length>0?e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-2 -mr-2",children:p.map((y,C)=>e.jsxs("div",{className:"flex items-center justify-between bg-[var(--bg-dark)]/50 p-3 rounded-lg group",children:[e.jsx("p",{className:"text-white text-sm",children:y}),e.jsx("button",{onClick:()=>G(y),className:"text-slate-500 hover:text-[var(--danger)] p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-500/20","aria-label":`ุญุฐู ุงูุฐุงูุฑุฉ: ${y}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]},C))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-[var(--text-secondary)]",children:"ุงูุฐุงูุฑุฉ ูุงุฑุบุฉ ุญุงููุงู."})})]}),f==="appearance"&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-4",children:"ุฎูููุฉ ุงููุญุงุฏุซุฉ"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsx(Y,{label:"ุฑูุงุจุท ููููู",value:"neon_nexus",previewClass:"bg-neon-nexus",isSelected:S==="neon_nexus",onClick:A}),e.jsx(Y,{label:"ุชูุงุฑ ุงูุจูุงูุงุช",value:"data_stream",previewClass:"bg-data-stream",isSelected:S==="data_stream",onClick:A}),e.jsx(Y,{label:"ุดุจูุฉ ููููุบุฑุงููุฉ",value:"holo_grid",previewClass:"bg-holo-grid",isSelected:S==="holo_grid",onClick:A}),e.jsx(Y,{label:"ุงูุดุจูุฉ ุงูุณูุจุฑุงููุฉ",value:"cyber_grid",previewClass:"bg-cyber-grid",isSelected:S==="cyber_grid",onClick:A}),e.jsx(Y,{label:"ุฏุงูู",value:"solid",previewClass:"bg-solid",isSelected:S==="solid",onClick:A})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 mt-4 bg-black/20 p-4 rounded-b-2xl border-t border-[var(--border-color)]",children:[e.jsx("button",{onClick:t,className:"py-2.5 px-6 rounded-xl bg-[var(--bg-surface-hover)] hover:bg-slate-600 transition-colors duration-200 font-semibold",children:"ุฅูุบุงุก"}),e.jsx("button",{onClick:z,disabled:!U,className:"py-2.5 px-6 rounded-xl bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] hover:shadow-lg hover:shadow-[var(--primary-from)]/30 font-semibold transition-all duration-200 disabled:from-slate-500 disabled:to-slate-600 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none",children:B?"ุฌุงุฑู ุงูุญูุธ...":"ุญูุธ ุงูุชุบููุฑุงุช"})]})]})})},We=({isOpen:r,onClose:t,conversations:n,activeConversationId:o,onSelectConversation:a,onNewChat:x,onDeleteConversation:d})=>{if(!r)return null;const v=(p,h)=>{p.stopPropagation(),window.confirm("ูู ุฃูุช ูุชุฃูุฏ ุฃูู ุชุฑูุฏ ุญุฐู ูุฐู ุงููุญุงุฏุซุฉุ ุณูุชู ุญุฐููุง ููุงุฆูุงู.")&&d(h)};return e.jsxs("div",{className:"fixed inset-0 z-50 transition-opacity",role:"dialog","aria-modal":"true","aria-labelledby":"history-panel-title",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in-0 duration-300",onClick:t}),e.jsxs("div",{className:`fixed top-0 bottom-0 bg-[var(--bg-surface)]/80 backdrop-blur-2xl border-l border-[var(--border-color)] w-full max-w-sm text-white shadow-2xl flex flex-col transition-transform duration-300 ease-in-out
                   ${r?"translate-x-0":"translate-x-full"} right-0`,dir:"rtl",children:[e.jsxs("header",{className:"p-4 border-b border-[var(--border-color)] flex-shrink-0 flex items-center justify-between",children:[e.jsx("h2",{id:"history-panel-title",className:"text-xl font-bold",children:"ุงููุญุงุฏุซุงุช"}),e.jsx("button",{onClick:t,className:"text-[var(--text-secondary)] hover:text-white p-2 rounded-full hover:bg-[var(--bg-surface-hover)]",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-3 flex-shrink-0 border-b border-[var(--border-color)]",children:e.jsxs("button",{onClick:x,className:"w-full flex items-center justify-center gap-2 py-3 px-4 rounded-xl bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] text-white hover:shadow-lg hover:shadow-[var(--primary-from)]/30 transition-all duration-300 font-bold transform hover:scale-[1.02]",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ"]})}),e.jsx("nav",{className:"flex-1 overflow-y-auto p-2",children:n.length>0?e.jsx("ul",{className:"space-y-1",children:n.map(p=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>a(p.id),className:`w-full text-right p-3 rounded-lg transition-colors flex items-center justify-between group relative
                                ${p.id===o?"bg-gradient-to-r from-[var(--primary-from)]/20 to-transparent text-white":"hover:bg-[var(--bg-surface-hover)] text-[var(--text-secondary)] hover:text-white"}`,children:[p.id===o&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-gradient-to-b from-[var(--primary-from)] to-[var(--primary-to)] rounded-r-full"}),e.jsx("span",{className:"truncate pr-2 font-semibold",children:p.title}),e.jsx("span",{onClick:h=>v(h,p.id),className:"text-slate-500 hover:text-[var(--danger)] p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-500/20","aria-label":"ุญุฐู ุงููุญุงุฏุซุฉ",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z",clipRule:"evenodd"})})})]})},p.id))}):e.jsxs("div",{className:"p-4 text-center text-[var(--text-secondary)] mt-8",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-16 w-16 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 5.523-4.477 10-10 10S1 17.523 1 12 5.477 2 11 2s10 4.477 10 10z"})}),e.jsx("p",{className:"mt-4 font-semibold",children:"ูุง ุชูุฌุฏ ูุญุงุฏุซุงุช ูุญููุธุฉ"}),e.jsx("p",{className:"text-sm",children:"ุงุจุฏุฃ ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ ูุชุธูุฑ ููุง."})]})})]})]})},pe=({className:r})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"smart-friend-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--primary-from)"}),e.jsx("stop",{offset:"100%",stopColor:"var(--primary-to)"})]})}),e.jsx("path",{stroke:"url(#smart-friend-gradient)",d:"M12 2a10 10 0 0 0-3.54 19.54"}),e.jsx("path",{stroke:"url(#smart-friend-gradient)",d:"M12 2a10 10 0 0 1 3.54 19.54"}),e.jsx("path",{stroke:"url(#smart-friend-gradient)",opacity:"0.6",d:"M4 13a8.1 8.1 0 0 1 0-2"}),e.jsx("path",{stroke:"url(#smart-friend-gradient)",opacity:"0.6",d:"M20 13a8.1 8.1 0 0 0 0-2"}),e.jsx("path",{stroke:"url(#smart-friend-gradient)",opacity:"0.8",d:"M6.34 17.66a5.1 5.1 0 0 1 0-3.32"}),e.jsx("path",{stroke:"url(#smart-friend-gradient)",opacity:"0.8",d:"M17.66 17.66a5.1 5.1 0 0 0 0-3.32"}),e.jsx("path",{stroke:"url(#smart-friend-gradient)",d:"M12 12a1 1 0 1 0 2 0a1 1 0 1 0-2 0"}),e.jsx("path",{stroke:"url(#smart-friend-gradient)",d:"M12 12a4 4 0 0 0-2.83-2.83"}),e.jsx("path",{stroke:"url(#smart-friend-gradient)",d:"M12 12a4 4 0 0 1 2.83 2.83"})]}),qe=({text:r,icon:t,onClick:n})=>e.jsx("button",{onClick:n,className:"bg-[var(--bg-surface)]/70 border border-[var(--border-color)] p-4 rounded-2xl text-right text-[var(--text-main)] transition-all duration-300 hover:bg-[var(--bg-surface-hover)] hover:border-[var(--primary-from)]/50 cursor-pointer hover:scale-105 group hover:shadow-lg hover:shadow-[var(--primary-from)]/10",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-gradient-to-br from-[var(--primary-from)]/10 to-[var(--primary-to)]/10 text-[var(--primary-from)] group-hover:text-white transition-colors duration-300",children:t}),e.jsx("p",{className:"font-semibold",children:r})]})}),Je=({onSendMessage:r})=>{const t=[{text:"ูุง ูู ุฃูุถู ููุชุฉ ุชุนุฑููุงุ",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 100-2 1 1 0 000 2zm7-1a1 1 0 11-2 0 1 1 0 012 0zm-.464 5.535a1 1 0 10-1.415-1.414 3 3 0 01-4.242 0 1 1 0 00-1.415 1.414 5 5 0 007.072 0z",clipRule:"evenodd"})})},{text:"ุงูุชุฑุญ ูููููุง ููุดุงูุฏุชู ุงููููุฉ",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M2 6a2 2 0 012-2h12a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"})})},{text:"ูููุนุจ ูุนุจุฉ ุฃุณุฆูุฉ (ุชุฑูููุง)",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})},{text:"ุณุงุนุฏูู ูู ูุชุงุจุฉ ุจุฑูุฏ ุฅููุชุฑููู",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),e.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]})}];return e.jsxs("div",{className:"flex-1 flex flex-col justify-center items-center text-center p-4 animate-in zoom-in-95 duration-500",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute -inset-4 bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] rounded-full blur-3xl opacity-20 animate-pulse-glow"}),e.jsx(pe,{className:"w-28 h-28 relative z-10 drop-shadow-[0_0_25px_rgba(0,169,255,0.4)]"})]}),e.jsx("h2",{className:"text-3xl font-extrabold text-[var(--text-main)] mb-2",children:"ุงุจุฏุฃ ูุญุงุฏุซุฉ"}),e.jsx("p",{className:"text-[var(--text-secondary)] max-w-sm text-lg",children:"ููููู ุฃู ุชุณุฃููู ุนู ุฃู ุดูุกุ ุฃู ุชุฎุชุงุฑ ุฃุญุฏ ุงูุงูุชุฑุงุญุงุช ููุจุฏุก."}),e.jsx("div",{className:"mt-12 w-full max-w-lg grid grid-cols-1 md:grid-cols-2 gap-3",children:t.map((n,o)=>e.jsx(qe,{text:n.text,icon:n.icon,onClick:()=>r(n.text)},o))})]})},Ke=({missionText:r})=>e.jsx("div",{className:"bg-gradient-to-r from-[var(--primary-from)]/10 via-[var(--bg-surface)]/10 to-transparent p-3 sm:p-4 border-t border-[var(--border-color)] animate-in fade-in duration-500",children:e.jsxs("div",{className:"flex items-center justify-center text-center gap-3",children:[e.jsx("span",{className:"text-[var(--primary-from)] shrink-0 animate-pulse",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})})}),e.jsx("div",{className:"text-sm",children:e.jsx("p",{className:"text-[var(--text-secondary)]",children:r})})]})}),Ye=({isOpen:r,onClose:t,messageToEdit:n,onConfirmEdit:o})=>{const[a,x]=m.useState(""),[d,v]=m.useState(!1);if(m.useEffect(()=>{r||setTimeout(()=>{x(""),v(!1)},300)},[r]),!r||!n)return null;const p=async f=>{f.preventDefault(),!(!a.trim()||d)&&(v(!0),await o(n,a.trim()))},h=`data:image/jpeg;base64,${n.base64Image}`;return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex justify-center items-center p-4 transition-opacity animate-in fade-in duration-300",onClick:t,role:"dialog","aria-modal":"true","aria-labelledby":"image-edit-title",children:e.jsxs("div",{className:"bg-[var(--bg-surface)]/80 backdrop-blur-2xl border border-[var(--border-color)] rounded-2xl shadow-2xl w-full max-w-2xl text-white transform transition-all animate-in zoom-in-95 duration-300 flex flex-col overflow-hidden",onClick:f=>f.stopPropagation(),dir:"rtl",children:[e.jsxs("header",{className:"p-4 md:p-6 border-b border-[var(--border-color)] flex-shrink-0",children:[e.jsx("h2",{id:"image-edit-title",className:"text-xl md:text-2xl font-bold text-center",children:"ุงูุชุนุฏูู ุงูุฅุจุฏุงุนู ููุตูุฑุฉ"}),e.jsx("p",{className:"text-center text-sm text-[var(--text-secondary)] mt-1",children:"ุตู ุงูุชุบููุฑ ุงูุฐู ุชุฑูุฏ ุฅุถุงูุชู ุนูู ุงูุตูุฑุฉ."})]}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"p-4 md:p-6 flex-grow overflow-y-auto flex flex-col md:flex-row gap-4 md:gap-6 items-center",children:[e.jsx("div",{className:"w-full md:w-1/2 flex-shrink-0",children:e.jsx("img",{src:h,alt:"Image to edit",className:"rounded-lg shadow-lg w-full aspect-square object-cover border border-white/10"})}),e.jsxs("div",{className:"w-full md:w-1/2 flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"modification",className:"block text-sm font-medium text-[var(--text-secondary)] mb-2",children:"ูุงุฐุง ุชุฑูุฏ ุฃู ุชุนุฏูุ"}),e.jsx("textarea",{id:"modification",value:a,onChange:f=>x(f.target.value),placeholder:"ูุซุงู: ุงุฌุนู ุงูุณูุงุก ุชูุทุฑุ ุฃุถู ูุจุนุฉ ุนูู ุงูุดุฎุตุ ุบูุฑ ุงูููุท ุฅูู ูุฑุชููู...",className:"w-full h-32 bg-[var(--bg-dark)] text-white rounded-xl py-3 px-4 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[var(--bg-surface)] focus:ring-[var(--primary-from)] transition border border-[var(--border-color)] resize-none",required:!0,disabled:d})]}),e.jsxs("div",{className:"text-xs text-[var(--text-secondary)] bg-[var(--bg-dark)]/50 p-2 rounded-md border border-[var(--border-color)]",children:[e.jsx("p",{className:"font-bold text-white",children:"ุงููุตู ุงูุฃุตูู ููุตูุฑุฉ:"}),e.jsx("p",{className:"font-mono text-slate-400 truncate",dir:"ltr",children:n.originalPrompt})]})]})]}),e.jsxs("footer",{className:"flex items-center justify-end gap-4 bg-black/20 p-4 rounded-b-2xl border-t border-[var(--border-color)]",children:[e.jsx("button",{type:"button",onClick:t,disabled:d,className:"py-2.5 px-6 rounded-xl bg-[var(--bg-surface-hover)] hover:bg-slate-600 transition-colors duration-200 font-semibold disabled:opacity-50",children:"ุฅูุบุงุก"}),e.jsx("button",{type:"submit",disabled:!a.trim()||d,className:"py-2.5 px-6 rounded-xl bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] hover:shadow-lg hover:shadow-[var(--primary-from)]/30 font-semibold transition-all duration-200 disabled:from-slate-500 disabled:to-slate-600 disabled:cursor-not-allowed disabled:shadow-none w-40 flex items-center justify-center",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-t-transparent border-white rounded-full animate-spin mr-2"}),e.jsx("span",{children:"ุฌุงุฑู ุงูุฅูุดุงุก..."})]}):"ุฃูุดุฆ ุงูุตูุฑุฉ"})]})]})]})})},Ze=r=>new Promise((t,n)=>{const o=new FileReader;o.readAsDataURL(r),o.onload=()=>{const a=o.result.split(",")[1];a?t(a):n(new Error("Failed to read file as Base64."))},o.onerror=a=>n(a)}),Qe="FriendAppData",Xe=1,X="userData";function et(){return new Promise((r,t)=>{const n=indexedDB.open(Qe,Xe);n.onerror=o=>t("IndexedDB error: "+o.target.errorCode),n.onsuccess=o=>r(o.target.result),n.onupgradeneeded=o=>{const a=o.target.result;a.objectStoreNames.contains(X)||a.createObjectStore(X,{keyPath:"id"})}})}const se=async r=>{try{(await et()).transaction([X],"readwrite").objectStore(X).put({...r,id:"currentUser"})}catch(t){console.error("Failed to save user data to IndexedDB:",t)}},oe=()=>new Date().toISOString().split("T")[0],tt=r=>{if(!r)return!1;const t=new Date;return t.setDate(t.getDate()-1),r===t.toISOString().split("T")[0]},rt=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-[var(--bg-dark)] text-[var(--text-main)] animate-in fade-in duration-500",children:[e.jsxs("div",{className:"relative w-32 h-32 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] rounded-full blur-3xl opacity-40 animate-pulse-glow"}),e.jsx(pe,{className:"w-28 h-28 text-white z-10 drop-shadow-[0_0_20px_rgba(0,169,255,0.5)]"})]}),e.jsx("p",{className:"text-[var(--text-secondary)] mt-8 text-lg font-semibold tracking-wider",children:"ุฌุงุฑู ุชุฌููุฒ ุนุงููู ุงูุฎุงุต..."})]}),at=({onSetupComplete:r})=>{const[t,n]=m.useState(""),[o,a]=m.useState("ุตุฏููู"),x=d=>{d.preventDefault(),t.trim()&&o.trim()&&r({userName:t.trim(),aiName:o.trim(),userAvatar:`https://api.dicebear.com/8.x/adventurer/svg?seed=${t.trim()}`,aiAvatar:`https://api.dicebear.com/8.x/bottts-neutral/svg?seed=${o.trim()}`,chatBackground:"neon_nexus",memory:[],notificationsEnabled:!1,dailyStreak:0,lastInteractionDate:"",dailyMission:{text:"",keyword:"",completed:!0}})};return e.jsx("div",{className:"flex items-center justify-center h-screen bg-[var(--bg-dark)] text-[var(--text-main)] p-4 animate-in fade-in",children:e.jsxs("div",{className:"w-full max-w-md bg-[var(--bg-surface)]/50 backdrop-blur-xl border border-[var(--border-color)] p-8 rounded-2xl shadow-2xl text-center shadow-[var(--primary-from)]/10",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto w-20 h-20 mb-4",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"setup-icon-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--primary-from)"}),e.jsx("stop",{offset:"100%",stopColor:"var(--primary-to)"})]})}),e.jsx("path",{d:"M10.49 2.21L10.27 2.32C6.93 3.99 4.51 7.28 4.51 11.02V12.98C4.51 16.72 6.93 20.01 10.27 21.68L10.49 21.79",stroke:"url(#setup-icon-gradient)",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M13.51 2.21L13.73 2.32C17.07 3.99 19.49 7.28 19.49 11.02V12.98C19.49 16.72 17.07 20.01 13.73 21.68L13.51 21.79",stroke:"url(#setup-icon-gradient)",strokeOpacity:"0.4",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("h1",{className:"text-3xl font-extrabold mb-2 bg-gradient-to-br from-white to-[var(--text-main)] bg-clip-text text-transparent",children:"ุตุฏุงูุฉ ุฌุฏูุฏุฉ"}),e.jsx("p",{className:"text-[var(--text-secondary)] mb-8",children:"ููุจุฏุฃ ุตุฏุงูุชูุง. ุนุฑูููู ุจููุณูุ ูุฃุนุทูู ุงุณูุงู ูุฃููู ุจู ุตุฏููู ุงูููุถู."}),e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsx("input",{type:"text",value:t,onChange:d=>n(d.target.value),placeholder:"ุงุณูู ุฃู ููุจู...",className:"w-full bg-[var(--bg-dark)] text-white rounded-xl py-3 px-4 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[var(--bg-dark)] focus:ring-[var(--primary-from)] transition border border-[var(--border-color)] placeholder:text-[var(--text-secondary)]",required:!0}),e.jsx("input",{type:"text",value:o,onChange:d=>a(d.target.value),placeholder:"ุงูุงุณู ุงูุฐู ุณุชูุงุฏููู ุจู...",className:"w-full bg-[var(--bg-dark)] text-white rounded-xl py-3 px-4 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[var(--bg-dark)] focus:ring-[var(--primary-from)] transition border border-[var(--border-color)] placeholder:text-[var(--text-secondary)]",required:!0}),e.jsx("button",{type:"submit",className:"w-full bg-gradient-to-br from-[var(--primary-from)] to-[var(--primary-to)] text-white font-bold py-3 px-4 rounded-xl hover:shadow-lg hover:shadow-[var(--primary-from)]/30 transition-all duration-300 transform hover:scale-105",children:"ููุจุฏุฃ ุฑุญูุชูุง"})]})]})})},he=[{mission:"ุงุณุฃููู ุนู ุงูุทูุณ ุงูููู",keyword:"weather"},{mission:"ุงุทูุจ ููู ุฃู ุฃุตู ูู ุตูุฑุฉ ููุทุฉ",keyword:"cat"},{mission:"ูู ูู ููุชุฉ",keyword:"joke"},{mission:"ูุง ูู ุงูุชุจุงุณ ุงูููู ุงูููููุ",keyword:"quote"},{mission:"ุงุทูุจ ููู ูุชุงุจุฉ ูุตูุฏุฉ ูุตูุฑุฉ ุนู ุงูุตุฏุงูุฉ",keyword:"poem"}],st=r=>{switch(r){case"data_stream":return"bg-data-stream";case"holo_grid":return"bg-holo-grid";case"cyber_grid":return"bg-cyber-grid";case"solid":return"bg-solid";case"neon_nexus":default:return"bg-neon-nexus"}},ot=()=>{const[r,t]=m.useState("LOADING"),[n,o]=m.useState([]),[a,x]=m.useState(null),[d,v]=m.useState(!1),[p,h]=m.useState(!1),[f,N]=m.useState(!1),[B,E]=m.useState(!1),[b,w]=m.useState([]),[S,A]=m.useState(null),[R,k]=m.useState(""),[z,G]=m.useState(null),U=m.useRef(null),y=m.useRef(null),C=n.find(s=>s.id===a),V=(C==null?void 0:C.messages)??[],g=C==null?void 0:C.userData,ee=m.useCallback((s,l={closeModal:!0})=>{if(!a)return;const i=g,c={...s,userAvatar:`https://api.dicebear.com/8.x/adventurer/svg?seed=${s.userName.trim()}`,aiAvatar:`https://api.dicebear.com/8.x/bottts-neutral/svg?seed=${s.aiName.trim()}`};se(c),o(u=>u.map(M=>{const _={...M.userData,...c};return M.id===a?(((i==null?void 0:i.aiName)!==c.aiName||(i==null?void 0:i.userName)!==c.userName)&&(U.current=K(c.aiName,c.userName,c.memory,M.messages)),{...M,userData:_,lastUpdated:Date.now()}):{...M,userData:_}})),l.closeModal&&N(!1)},[a,g]);m.useEffect(()=>{const s=()=>{const l=window.speechSynthesis.getVoices();l.length>0&&w(l.filter(i=>i.lang.startsWith("ar")))};return window.speechSynthesis.onvoiceschanged=s,s(),()=>{window.speechSynthesis.onvoiceschanged=null,window.speechSynthesis.cancel()}},[]),m.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(s=>console.log("Service Worker registered with scope:",s.scope)).catch(s=>console.log("Service Worker registration failed:",s))},[]),m.useEffect(()=>{"serviceWorker"in navigator&&"PeriodicSyncManager"in window&&navigator.serviceWorker.ready.then(async s=>{if(Notification.permission!=="granted"){try{await s.periodicSync.unregister("check-in-notification")}catch{}return}if(g!=null&&g.notificationsEnabled)try{(await s.periodicSync.getTags()).includes("check-in-notification")||await s.periodicSync.register("check-in-notification",{minInterval:2*60*60*1e3})}catch(l){console.error("Periodic sync could not be registered!",l)}else try{await s.periodicSync.unregister("check-in-notification")}catch(l){console.error("Periodic sync could not be unregistered!",l)}})},[g==null?void 0:g.notificationsEnabled]),m.useEffect(()=>{setTimeout(async()=>{try{const l=localStorage.getItem("conversations");if(l){const i=JSON.parse(l);if(i.length>0){const c=i.sort((T,P)=>P.lastUpdated-T.lastUpdated);let u={...c[0].userData};const M=oe();let _=!1;if(u.lastInteractionDate!==M){_=!0;let T=u.dailyStreak||0;tt(u.lastInteractionDate)?T++:T=1,u.dailyStreak=T;try{const P=await Le(),F=JSON.parse(P.text);u.dailyMission={text:F.mission,keyword:F.keyword.toLowerCase(),completed:!1}}catch(P){console.error("Failed to fetch daily mission, using fallback.",P);const F=he[Math.floor(Math.random()*he.length)];u.dailyMission={text:F.mission,keyword:F.keyword,completed:!1}}}let j=c.map(T=>({...T,userData:{...T.userData,chatBackground:T.userData.chatBackground||"neon_nexus"}}));_&&(j=j.map(T=>({...T,userData:{...T.userData,dailyStreak:u.dailyStreak,dailyMission:u.dailyMission}})),se(u)),o(j);const $=j[0];x($.id);const{aiName:O,userName:L,memory:q}=$.userData;U.current=K(O,L,q||[],$.messages),t("CHAT")}else t("SETUP")}else t("SETUP")}catch(l){console.error("Failed to parse data from localStorage",l),localStorage.clear(),t("SETUP")}},1500)},[]),m.useEffect(()=>{if(r==="CHAT"&&n.length>0)try{const s=n.map(l=>({...l,messages:l.messages.map(({imageUrl:i,...c})=>({...c,base64Image:c.sender==="ai"?c.base64Image:void 0,mimeType:c.sender==="ai"?c.mimeType:void 0}))}));localStorage.setItem("conversations",JSON.stringify(s))}catch(s){console.error("Failed to save conversations",s)}},[n,r]),m.useEffect(()=>{y.current&&(y.current.scrollTop=y.current.scrollHeight)},[V,p]);const ge=s=>{const l=`convo-${Date.now()}`,i={id:l,title:`ูุญุงุฏุซุฉ ูุน ${s.aiName}`,messages:[{id:"init",text:`ุฃููุงู ูุง ${s.userName}! ุฃูุง ${s.aiName}ุ ููุจุณูุท ุฌุฏูุง ุฅูู ูููู ุตุฏููู. ููุง ุจููุง ูุชููู! ๐`,sender:"ai"}],userData:s,lastUpdated:Date.now()};o([i]),x(l),se(s),U.current=K(s.aiName,s.userName,s.memory||[],[]),t("CHAT")},ie=s=>{const l=n.find(i=>i.id===s);if(l){window.speechSynthesis.cancel(),A(null),x(s);const{aiName:i,userName:c,memory:u}=l.userData;U.current=K(i,c,u||[],l.messages),E(!1)}},ve=()=>{const s=n.sort((O,L)=>L.lastUpdated-O.lastUpdated)[0];if(!s)return;const l=s.userData,i=[`ุฅุฒูู ูุง ${l.userName}! ุฅูู ุงูุฃุฎุจุงุฑุ ููุง ุจููุง ูููู ููุงู. ๐`,`ุฃููุงู ูุง ุตุงุญุจู ${l.userName}! ุนุงูู ุฅูู ุงูููุงุฑุฏุฉุ ูุณุชุนุฏ ูุฏุฑุฏุดุฉ ุฌุฏูุฏุฉุ ๐ค`],c=i[Math.floor(Math.random()*i.length)],u=`convo-${Date.now()}`,M={id:u,title:"ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ",messages:[{id:"init",text:c,sender:"ai"}],userData:l,lastUpdated:Date.now()};o(O=>[M,...O.sort((L,q)=>q.lastUpdated-L.lastUpdated)]),x(u);const{aiName:_,userName:j,memory:$}=l;U.current=K(_,j,$||[],[]),E(!1)},be=s=>{const l=n.filter(i=>i.id!==s);if(o(l),a===s)if(window.speechSynthesis.cancel(),l.length>0){const i=l.sort((c,u)=>u.lastUpdated-c.lastUpdated)[0];ie(i.id)}else x(null),localStorage.removeItem("conversations"),t("SETUP")},we=(s,l,i)=>{o(c=>c.map(u=>u.id===s?{...u,messages:u.messages.map(M=>M.id===l?{...M,...i}:M),lastUpdated:Date.now()}:u))},I=(s,l)=>{o(i=>i.map(c=>c.id===s?{...c,messages:[...c.messages,l],lastUpdated:Date.now()}:c))},ye=s=>{a&&o(l=>l.map(i=>{const c=i.userData.memory||[];if(!c.includes(s)){const u={...i.userData,memory:[...c,s]};return{...i,userData:u}}return i}))},je=(s,l)=>{if(window.speechSynthesis.cancel(),S===l){A(null);return}const i=new SpeechSynthesisUtterance(s),c=b.find(u=>u.lang==="ar-EG")||b.find(u=>u.lang.startsWith("ar-"));c?(i.voice=c,i.lang=c.lang):i.lang="ar-EG",i.rate=.95,i.pitch=1,i.onstart=()=>A(l),i.onend=()=>A(null),i.onerror=()=>{A(null),console.error("Speech synthesis error")},window.speechSynthesis.speak(i)},Ne=async()=>{if(!(!a||!g)){v(!0),I(a,{id:`ai-${Date.now()}`,sender:"ai",text:"ุจุงูุชุฃููุฏ! ูููุนุจ ููููุงู. ุฅููู ุณุคุงู..."}),h(!0);try{const s=await Be(),l=JSON.parse(s.text),i={id:`trivia-${Date.now()}`,sender:"ai",text:"",type:"trivia",trivia:{question:l.question,options:l.options,answer:l.answer}};I(a,i)}catch(s){console.error("Failed to start trivia",s),I(a,{id:`err-${Date.now()}`,sender:"ai",text:"ุนููุงูุ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญุถูุฑ ุงูุณุคุงู. ููุฌุฑุจ ุดูุฆุงู ุขุฎุฑุ"})}finally{v(!1),h(!1)}}},ke=(s,l)=>{if(!a)return;const i=V.find(j=>j.id===s);if(!i||!i.trivia||i.trivia.userAnswer)return;const c=l===i.trivia.answer,u={...i.trivia,userAnswer:l,isCorrect:c};we(a,s,{trivia:u});const M=c?"ุฑุงุฆุน! ุฅุฌุงุจุฉ ุตุญูุญุฉ. ๐":`ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ. ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูู: "${i.trivia.answer}".`,_={id:`ai-resp-${Date.now()}`,sender:"ai",text:`${M} ูู ุชุฑูุฏ ุฃู ููุนุจ ุฌููุฉ ุฃุฎุฑูุ`};setTimeout(()=>I(a,_),500)},Ce=s=>{s.type==="generated_image"&&G(s)},Me=async(s,l)=>{if(!(!a||!s.originalPrompt))try{const i=await De(s.originalPrompt,l);I(a,{id:`user-edit-${Date.now()}`,sender:"user",text:`ุชุนุฏูู ุนูู ุงูุตูุฑุฉ: "${l}"`}),h(!0);const c=await ue(i),u={id:`ai-edited-${Date.now()}`,sender:"ai",type:"generated_image",text:"ุชูุถูุ ูุฐู ูู ุงูุตูุฑุฉ ุจุนุฏ ุงูุชุนุฏูู. ูู ุฃุนุฌุจุชูุ",base64Image:c,originalPrompt:i};I(a,u)}catch(i){console.error("Failed to edit image:",i),I(a,{id:`err-${Date.now()}`,sender:"ai",text:"ุนููุงูุ ูุงุฌูุช ูุดููุฉ ุฃุซูุงุก ุชุนุฏูู ุงูุตูุฑุฉ. ููุฌุฑุจ ุดูุฆุงู ุขุฎุฑ."})}finally{h(!1),G(null)}},ne=async(s,l)=>{var u,M,_;if(!U.current||d||!a||!g||!s&&!l)return;if(/ุชุฑูููุง|ุงุณุฆูู|ุฃุณุฆูุฉ|ูุนุจุฉ|game|trivia/i.test(s)){k(""),await Ne();return}if(v(!0),k(""),g.lastInteractionDate!==oe()&&ee({...g,lastInteractionDate:oe()},{closeModal:!1}),g.dailyMission&&!g.dailyMission.completed&&s.toLowerCase().includes(g.dailyMission.keyword)){const j={...g,dailyMission:{...g.dailyMission,completed:!0}};ee(j,{closeModal:!1}),I(a,{id:`mission-${Date.now()}`,sender:"ai",type:"mission_completed",text:"ุฃุญุณูุช! ููุฏ ุฃูููุช ูููุฉ ุงูููู."})}let i,c;if(l)try{const j=await Ze(l),$=l.type,L=$.startsWith("image/")?URL.createObjectURL(l):void 0;L&&(c=L),i={id:`user-${Date.now()}`,text:s,sender:"user",imageUrl:L,base64Image:j,mimeType:$,fileName:l.name}}catch(j){console.error("Error processing user file:",j),I(a,{id:`error-file-${Date.now()}`,text:"ุนุฐุฑุงูุ ูู ุฃุชููู ูู ูุฑุงุกุฉ ุงูููู ุงููุฑูู.",sender:"ai"}),v(!1);return}else i={id:`user-${Date.now()}`,text:s,sender:"user"};I(a,i),(C==null?void 0:C.messages.length)<4&&s&&C.title==="ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ"&&o(j=>j.map($=>$.id===a?{...$,title:s.substring(0,40)+(s.length>40?"...":""),lastUpdated:Date.now()}:$)),h(!0);try{const j=[];s&&j.push({text:s}),i.base64Image&&i.mimeType&&j.push({inlineData:{data:i.base64Image,mimeType:i.mimeType}});const $=await U.current.sendMessage({message:j});h(!1);let O=$.text||"";const L=(_=(M=(u=$.candidates)==null?void 0:u[0])==null?void 0:M.groundingMetadata)==null?void 0:_.groundingChunks,q=/<THINK>MEMORIZE: (.*?)<\/THINK>/s,T=O.match(q);T&&T[1]&&ye(T[1].trim());let P=O.replace(q,"").trim();const F=/<GENERATE_IMAGE_PROMPT>(.*?)<\/GENERATE_IMAGE_PROMPT>/s,te=P.match(F);if(te&&te[1]){h(!0);const W=te[1].trim();try{const D=await ue(W),ae={id:`ai-gen-${Date.now()}`,sender:"ai",type:"generated_image",text:"ุจุงูุชุฃููุฏุ ุชู ุฅูุดุงุก ูุฐู ุงูุตูุฑุฉ ุฎุตูุตูุง ูู.",base64Image:D,originalPrompt:W,mimeType:"image/jpeg"};I(a,ae)}catch(D){console.error("Image generation failed:",D),I(a,{id:`error-img-${Date.now()}`,text:"ุนูููุงุ ูุงุฌูุช ูุดููุฉ ุฃุซูุงุก ูุญุงููุฉ ุฅูุดุงุก ุงูุตูุฑุฉ. ููุฌุฑุจ ููุฑุฉ ุฃุฎุฑูุ",sender:"ai"})}h(!1);return}const re=P.match(/\[IMAGE_URL\](.*?)\[\/IMAGE_URL\]/s);let J;if(re&&re[1]){const W=re[1].trim(),D=P.replace(/\[IMAGE_URL\].*?\[\/IMAGE_URL\]/s,"").trim();J={id:`ai-${Date.now()}`,sender:"ai",text:D,imageUrl:W,mimeType:"image/png"}}else J={id:`ai-${Date.now()}`,text:P,sender:"ai"};if((J.text||J.imageUrl)&&I(a,J),L&&L.length>0){const W=L.map((D,ae)=>{var le,de;const Q=(le=D==null?void 0:D.web)==null?void 0:le.uri,Te=((de=D==null?void 0:D.web)==null?void 0:de.title)||Q;return typeof Q=="string"&&Q?`${ae+1}. [${String(Te).replace(/[\[\]]/g,"")}](${Q})`:null}).filter(Boolean).join(`
`);if(W){const D={id:`source-${Date.now()}`,sender:"ai",type:"source_info",text:`**ุงููุตุงุฏุฑ:**
${W}`};I(a,D)}}}catch(j){console.error("Error sending message:",j),I(a,{id:`error-${Date.now()}`,text:"ุนูููุง ูุง ุตุฏูููุ ุญุฏุซ ุฎุทุฃ ูุง. ูู ููููู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุจุนุฏ ููููุ",sender:"ai"})}finally{v(!1),h(!1),c&&URL.revokeObjectURL(c)}};if(r==="LOADING")return e.jsx(rt,{});if(r==="SETUP"||!g||!C)return e.jsx(at,{onSetupComplete:ge});const Se=V.length===1&&V[0].id==="init",Re=st(g.chatBackground);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex flex-col h-screen bg-transparent text-white md:max-w-5xl md:mx-auto md:border-x md:border-[var(--border-color)] md:shadow-2xl md:shadow-black/50 relative overflow-hidden ${Re}`,dir:"rtl",children:[e.jsx("div",{className:"absolute top-0 right-0 left-0 h-96 bg-gradient-to-b from-[var(--bg-dark)]/80 via-[var(--bg-surface)]/20 to-transparent -z-10"}),e.jsx(Ue,{aiName:g.aiName,aiAvatar:g.aiAvatar,dailyStreak:g.dailyStreak||0,onOpenSettings:()=>N(!0),onToggleSidebar:()=>E(!0)}),e.jsxs("main",{ref:y,className:"flex-1 overflow-y-auto p-2 sm:p-4 space-y-2 flex flex-col",children:[Se?e.jsx(Je,{onSendMessage:s=>ne(s)}):V.map(s=>e.jsx(Ge,{message:s,avatar:s.sender==="ai"?g.aiAvatar:g.userAvatar,onPlayAudio:je,isSpeaking:S===s.id,onAnswerTrivia:ke,onEditImage:Ce},s.id)),p&&e.jsx(Ve,{})]}),e.jsxs("div",{className:"flex-shrink-0",children:[g.dailyMission&&!g.dailyMission.completed&&e.jsx(Ke,{missionText:g.dailyMission.text}),e.jsx(He,{onSendMessage:ne,isLoading:d,inputValue:R,setInputValue:k})]})]}),e.jsx(We,{isOpen:B,onClose:()=>E(!1),conversations:n,activeConversationId:a,onSelectConversation:ie,onNewChat:ve,onDeleteConversation:be}),e.jsx(Fe,{isOpen:f,onClose:()=>N(!1),onSave:ee,userData:g}),e.jsx(Ye,{isOpen:!!z,onClose:()=>G(null),messageToEdit:z,onConfirmEdit:Me})]})},fe=document.getElementById("root");if(!fe)throw new Error("Could not find root element to mount to");const it=Ee.createRoot(fe);it.render(e.jsx(Ae.StrictMode,{children:e.jsx(ot,{})}));
